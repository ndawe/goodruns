
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>goodruns &mdash; goodruns 1.5 documentation</title>
    
    <link rel="stylesheet" href="_static/clean.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="goodruns 1.5 documentation" href="#" /> 
  </head>
  <body>
  
  
  <div class=indexwrapper>
  


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="goodruns">
<h1>goodruns<a class="headerlink" href="#goodruns" title="Permalink to this headline">¶</a></h1>
<p>goodruns provides an implementation of an ATLAS &#8220;good run list&#8221; (GRL)
reader/writer in Python, and collection of useful command-line tools.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>goodruns requires at least Python 2.5 and only depends on modules in the standard library.
For better XML reading/writing goodruns will optionally use <a class="reference external" href="http://pypi.python.org/pypi/lxml/2.3">lxml</a>
if installed. Install <a class="reference external" href="http://pypi.python.org/pypi/PyYAML/">PyYAML</a> if you would
like to convert GRLs into YAML format.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to install goodruns is with <tt class="docutils literal"><span class="pre">pip</span></tt>.
To install for all users:</p>
<div class="highlight-python"><pre>sudo pip install goodruns</pre>
</div>
<p>To install in your home directory:</p>
<div class="highlight-python"><pre>pip install --user goodruns</pre>
</div>
<p>If you have obtained a copy of goodruns yourself use the <tt class="docutils literal"><span class="pre">setup.py</span></tt>
script to install. To install for all users:</p>
<div class="highlight-python"><pre>sudo python setup.py install</pre>
</div>
<p>To install in your home directory:</p>
<div class="highlight-python"><pre>python setup.py install --user</pre>
</div>
<p>To install the optional dependencies:</p>
<div class="highlight-python"><pre>pip install -U -r optional-requirements.txt</pre>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>An example of how to use goodruns:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">goodruns</span> <span class="kn">import</span> <span class="n">GRL</span>

<span class="n">grl</span> <span class="o">=</span> <span class="n">GRL</span><span class="p">(</span><span class="s">&#39;grl.xml&#39;</span><span class="p">)</span>
<span class="c"># or:</span>
<span class="n">grl</span> <span class="o">=</span> <span class="n">GRL</span><span class="p">(</span><span class="s">&#39;http://atlasdqm.web.cern.ch/atlasdqm/grlgen/path/to/grl.xml&#39;</span><span class="p">)</span>

<span class="c"># check if the GRL contains the lumiblock 231 in run 186356:</span>
<span class="k">if</span> <span class="p">(</span><span class="mi">186356</span><span class="p">,</span> <span class="mi">231</span><span class="p">)</span> <span class="ow">in</span> <span class="n">grl</span><span class="p">:</span>
    <span class="c"># do something</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>The GRL is automatically optimized (lumiblocks are merged and sorted):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">goodruns</span> <span class="kn">import</span> <span class="n">GRL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">GRL</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">---------------</span>
<span class="go">RUN: 1</span>
<span class="go">LUMIBLOCKS:</span>
<span class="go">  1 - 4</span>
<span class="go">  7 - 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">---------------</span>
<span class="go">RUN: 1</span>
<span class="go">LUMIBLOCKS:</span>
<span class="go">  1 - 4</span>
<span class="go">  6 - 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">---------------</span>
<span class="go">RUN: 1</span>
<span class="go">LUMIBLOCKS:</span>
<span class="go">  1 - 10</span>
</pre></div>
</div>
</div>
<div class="section" id="command-line-tools">
<h2>Command-line Tools<a class="headerlink" href="#command-line-tools" title="Permalink to this headline">¶</a></h2>
<p>goodruns also provides a collection of command-line tools
for combining, manipulating, and inspecting GRLs.</p>
<div class="section" id="grl-diff">
<h3>grl-diff<a class="headerlink" href="#grl-diff" title="Permalink to this headline">¶</a></h3>
<p>Use <tt class="docutils literal"><span class="pre">grl-diff</span></tt> to determine the GRL containing the runs/lumiblocks in <tt class="docutils literal"><span class="pre">A.xml</span></tt> but not in <tt class="docutils literal"><span class="pre">B.xml</span></tt>:</p>
<div class="highlight-python"><pre>grl-diff A.xml B.xml</pre>
</div>
<p>In other words, <tt class="docutils literal"><span class="pre">B.xml</span></tt> is subtracted from <tt class="docutils literal"><span class="pre">A.xml</span></tt>.
All command-line tools print on stdout. Redirect stdout to a file to save the result:</p>
<div class="highlight-python"><pre>grl-diff A.xml B.xml &gt; C.xml</pre>
</div>
<p>You may supply more than two GRLs to <tt class="docutils literal"><span class="pre">grl-diff</span></tt>:</p>
<div class="highlight-python"><pre>grl-diff A.xml B.xml C.xml D.xml &gt; E.xml</pre>
</div>
<p>which results in the GRL E=((A-B)-C)-D). This is equivalent to:</p>
<div class="highlight-python"><pre>grl-diff A.xml B.xml | grl-diff C.xml | grl-diff D.xml &gt; E.xml</pre>
</div>
<p>The output of one command can be piped into any of the other commands in goodruns.</p>
</div>
<div class="section" id="grl-and-grl-or-grl-xor">
<h3>grl-and, grl-or, grl-xor<a class="headerlink" href="#grl-and-grl-or-grl-xor" title="Permalink to this headline">¶</a></h3>
<p>These scripts implement logical combinations of GRLs. Logical AND:</p>
<div class="highlight-python"><pre>grl-and A.xml B.xml &gt; C.xml</pre>
</div>
<p>OR:</p>
<div class="highlight-python"><pre>grl-or A.xml B.xml &gt; C.xml</pre>
</div>
<p>and XOR (exclusive OR):</p>
<div class="highlight-python"><pre>grl-xor A.xml B.xml &gt; C.xml</pre>
</div>
<p>Again, these commands can be combined arbitrarily:</p>
<div class="highlight-python"><pre>grl-and A.xml B.xml | grl-or C.xml | grl-xor D.xml &gt; E.xml</pre>
</div>
</div>
<div class="section" id="grl-clip">
<h3>grl-clip<a class="headerlink" href="#grl-clip" title="Permalink to this headline">¶</a></h3>
<p>Use <tt class="docutils literal"><span class="pre">grl-clip</span></tt> to truncate a GRL between a starting run/lumiblock and ending run/lumiblock:</p>
<div class="highlight-python"><pre>&gt; grl-clip --help
Usage: grl-clip [options] [file]

Options:
  -h, --help            show this help message and exit
  -o OUTPUT, --output=OUTPUT
                        Output filename
  --startrun=STARTRUN   Start run
  --startlb=STARTLB     Start lumiblock
  --endrun=ENDRUN       End run
  --endlb=ENDLB         End lumiblock</pre>
</div>
</div>
<div class="section" id="grl-convert">
<h3>grl-convert<a class="headerlink" href="#grl-convert" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">grl-convert</span></tt> can convert a GRL from XML format into YAML:</p>
<div class="highlight-python"><pre>&gt; grl-convert -f yml A.xml
186178:
- !!python/tuple [125, 156]
- !!python/tuple [158, 161]
186179:
- !!python/tuple [382, 388]
- !!python/tuple [390, 390]
- !!python/tuple [396, 396]
- !!python/tuple [398, 415]
- !!python/tuple [417, 431]
- !!python/tuple [433, 453]
- !!python/tuple [455, 469]
- !!python/tuple [471, 474]
- !!python/tuple [476, 479]
186180:
- !!python/tuple [114, 116]
- !!python/tuple [118, 124]
- !!python/tuple [126, 140]
- !!python/tuple [144, 149]
- !!python/tuple [151, 170]
- !!python/tuple [173, 176]
...</pre>
</div>
<p>or plain text format:</p>
<div class="highlight-python"><pre>&gt; grl-convert -f txt A.xml
---------------
RUN: 186178
LUMIBLOCKS:
  125 - 156
  158 - 161
---------------
RUN: 186179
LUMIBLOCKS:
  382 - 388
  390
  396
  398 - 415
  417 - 431
  433 - 453
  455 - 469
  471 - 474
  476 - 479
---------------
RUN: 186180
LUMIBLOCKS:
  114 - 116
  118 - 124
  126 - 140
  144 - 149
  151 - 170
  173 - 176
...</pre>
</div>
<p><tt class="docutils literal"><span class="pre">grl-convert</span></tt> will also convert a GRL into Python code (dict of lists of tuples) or (as a joke) a ROOT TCut expression.</p>
</div>
<div class="section" id="grl-runs">
<h3>grl-runs<a class="headerlink" href="#grl-runs" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">grl-runs</span></tt> simply prints the run numbers, one per line, contained within a GRL:</p>
<div class="highlight-python"><pre>&gt; grl-runs A.xml
186178
186179
186180
...</pre>
</div>
<p>Quickly print the runs contained in a GRL from a URL:</p>
<div class="highlight-python"><pre>&gt; grl-runs http://atlasdqm.web.cern.ch/atlasdqm/grlgen/path/to/grl.xml</pre>
</div>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-goodruns.grl">
<span id="goodruns-grl"></span><h3><a class="reference internal" href="#module-goodruns.grl" title="goodruns.grl"><tt class="xref py py-mod docutils literal"><span class="pre">goodruns.grl</span></tt></a><a class="headerlink" href="#module-goodruns.grl" title="Permalink to this headline">¶</a></h3>
<p>This module provides the main GRL class and utility functions</p>
<dl class="class">
<dt id="goodruns.grl.GRL">
<em class="property">class </em><tt class="descclassname">goodruns.grl.</tt><tt class="descname">GRL</tt><big>(</big><em>grl=None</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL" title="Permalink to this definition">¶</a></dt>
<dd><p>The main GRL class holds a python dictionary
mapping runs to a list of lumiblock ranges (2-tuples)</p>
<p>grl may be a file name or URL of a valid GRL file, or None</p>
<dl class="method">
<dt id="goodruns.grl.GRL.clip">
<tt class="descname">clip</tt><big>(</big><em>startrun=None</em>, <em>startlb=None</em>, <em>endrun=None</em>, <em>endlb=None</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.clip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip the GRL between startrun, startlb and endrun, endlb (inclusive)</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.cut">
<tt class="descname">cut</tt><big>(</big><em>runname='RunNumber'</em>, <em>lbname='lbn'</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.cut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.cut" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert this GRL into a TCut expression.
This method is really meant to be a joke and should be of no use.</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.has_run">
<tt class="descname">has_run</tt><big>(</big><em>run</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.has_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.has_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if run is in GRL, else False</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.insert">
<tt class="descname">insert</tt><big>(</big><em>run</em>, <em>lbrange</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a lumiblock range into a run</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.items">
<tt class="descname">items</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.items" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over (run, lbranges) in GRL</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.iterruns">
<tt class="descname">iterruns</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.iterruns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.iterruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over runs in GRL</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.remove">
<tt class="descname">remove</tt><big>(</big><em>run</em>, <em>lbrange</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a lumiblock range from a run</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.runs">
<tt class="descname">runs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.runs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of runs in GRL</p>
</dd></dl>

<dl class="method">
<dt id="goodruns.grl.GRL.write">
<tt class="descname">write</tt><big>(</big><em>filehandle</em>, <em>format='xml'</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#GRL.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.GRL.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the GRL in a specified format to the file object.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="goodruns.grl.LumiblockRange">
<em class="property">class </em><tt class="descclassname">goodruns.grl.</tt><tt class="descname">LumiblockRange</tt><a class="reference internal" href="_modules/goodruns/grl.html#LumiblockRange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.LumiblockRange" title="Permalink to this definition">¶</a></dt>
<dd><p>A 2-tuple consisting of the lower and upper
bounds of a lumiblock range</p>
</dd></dl>

<dl class="function">
<dt id="goodruns.grl.anded">
<tt class="descclassname">goodruns.grl.</tt><tt class="descname">anded</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#anded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.anded" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the AND of multiple GRLs: A &amp; B &amp; C...</p>
</dd></dl>

<dl class="function">
<dt id="goodruns.grl.clipped">
<tt class="descclassname">goodruns.grl.</tt><tt class="descname">clipped</tt><big>(</big><em>grl</em>, <em>startrun=None</em>, <em>startlb=None</em>, <em>endrun=None</em>, <em>endlb=None</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#clipped"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.clipped" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip a GRL between startrun, startlb and endrun, endlb (inclusive)</p>
</dd></dl>

<dl class="function">
<dt id="goodruns.grl.diffed">
<tt class="descclassname">goodruns.grl.</tt><tt class="descname">diffed</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#diffed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.diffed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the difference of multiple GRLs: (((A-B)-C)-D)...)</p>
</dd></dl>

<dl class="function">
<dt id="goodruns.grl.ored">
<tt class="descclassname">goodruns.grl.</tt><tt class="descname">ored</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#ored"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.ored" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the OR of multiple GRLs: A | B | C...</p>
</dd></dl>

<dl class="function">
<dt id="goodruns.grl.xored">
<tt class="descclassname">goodruns.grl.</tt><tt class="descname">xored</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/goodruns/grl.html#xored"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#goodruns.grl.xored" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the XOR of multiple GRLs: A ^ B ^ C...</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <a href="http://github.com/ndawe/goodruns"><img style="position: fixed; top: 0; right: 0; border: 0;"
    src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
  

  
  </div>
  

  </body>
</html>